var b=io.connect("http://localhost:5092"),f,g,k=!0;b.b("connect",function(){f=prompt("Who are you?");b.c("addMe",f);console.log(f)});b.b("serverSelfMsg",function(a){$("#userMsgContainer").append($("<div>").text(a).a("userMessage"))});b.b("serverOthersMsg",function(a){$("#partnerMsgContainer").append($("<div>").text(a).a("partnerMessage"))});b.b("partnerMsgLike",function(a){$('.userMessage:contains("'+a+'")').find(".likeBt").a("clicked")});
b.b("partnerMsgDislike",function(a){$('.userMessage:contains("'+a+'")').find(".likeBt").g("clicked")});
b.b("chat",function(a){var c=a.v.replace("\n","<br>"),d=a.uid,e=a.w;a=$("<input>").a("shareBt").j({type:"button",value:""});var h=$("<input>").a("likeBt").j({type:"button",value:""}),m=$("<input>").a("translateBt").j({type:"button",value:"Translate"}),e=$("<span>").a("timeStamp").u().i(e),c=$("<span>").a("msgContent").i(c+"<br>").append(e);d==f?(d=$("#userMsgContainer"),c=c.append(a).append(h),c=$("<div>").a("userMessage").append(c)):(d=$("#partnerMsgContainer"),c=c.append(m).append(h),c=$("<div>").a("partnerMessage").append(c),
1==k&&c.find(".msgContent").a("block"));d.append(c);d.scrollTop(d.j("scrollHeight"))});b.b("partnerMsgBlock",function(a){k=a;$(".partnerMessage").l(function(){$(this).f("share")||(1==k?$(this).find(".msgContent").a("block"):$(this).find(".msgContent").g("block"))})});b.b("partnerMsgShare",function(a){a=$('.partnerMessage:contains("'+a+'")');a.f("share")?(a.g("share"),a.find(".msgContent").a("block")):(a.a("share"),a.find(".msgContent").g("block"))});
b.b("is BINDED",function(a){var c=a.m+" ("+a.B+")",d=$(".msgContent:contains('"+a.timeStamp+"')").h("div"),e=d.parent(),h=e.scrollTop();d.i(d.i().replace(a.m,'<span class = "highlight" >'+c+"</span>"));e.scrollTop(h)});function l(a){a.f("clicked")?a.g("clicked"):a.a("clicked")}$("#blockAll").click(function(){l($(this));$(this).f("clicked")?b.c("blockMsg",!0):b.c("blockMsg",!1)});
$("#container").b("click",".partnerMessage input.likeBt",function(){l($(this));var a=$(this).h(".partnerMessage");$(this).f("clicked")?b.c("likeMsg",a.find(".timeStamp").text()):b.c("dislikeMsg",a.find(".timeStamp").text())});$("#container").b("click","input.shareBt",function(){l($(this));var a=$(this).h(".userMessage");$(this).f("clicked")?a.a("share"):a.g("share");b.c("shareMsg",a.find(".timeStamp").text())});
$("#container").b("mouseup",".partnerMessage",function(){g=n().toString();$(".partnerMessage").l(function(){$(this).g("selected")});""!=g&&$('.partnerMessage:contains("'+g+'")').a("selected")});$("#container").b("click","input.translateBt",function(){var a=$(this).h(".partnerMessage"),c={C:g,timeStamp:a.find(".timeStamp").text(),s:$("#oriLang").o(),A:$("#transLang").o()};a.f("selected")&&b.c("translate",c)});
function n(){var a="";window.getSelection?a=window.getSelection():document.getSelection?a=document.getSelection():document.selection&&(a=document.selection.createRange().text);return a}$(document).ready(function(){$("#sendButton")});